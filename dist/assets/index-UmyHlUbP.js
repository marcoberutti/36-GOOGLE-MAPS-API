(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}})();const O=n=>{const e="The Google Maps JavaScript API",r="google",a="importLibrary",t="__ib__",o=document,i=window;i[r]=i[r]||{};const l=i[r].maps=i[r].maps||{},c=new Set,s=new URLSearchParams;let d=null;const A=()=>d||(d=new Promise(async(m,w)=>{const p=o.createElement("script");s.set("libraries",[...c]+"");for(let v in n){const I=v.replace(/[A-Z]/g,_=>"_"+_[0].toLowerCase());s.set(I,n[v])}s.set("callback",`${r}.maps.${t}`),p.src=`https://maps.${r}apis.com/maps/api/js?${s}`,p.onerror=()=>{d=w(Error(`${e} could not load.`))};const f=o.querySelector("script[nonce]");f!=null&&f.nonce&&(p.nonce=f.nonce),l[t]=m,o.head.append(p)}));l[a]?console.warn(`${e} only loads once. Ignoring:`,n):l[a]=(m,...w)=>(c.add(m),A().then(()=>l[a](m,...w)))},P="AIzaSyCsGl4s0BvZSQm75Wv7JO4cMmQudYmMG1E";window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.startsWith("192.168.")||window.location.hostname.startsWith("10.")||window.location.hostname.startsWith("172.16.");const W={key:P,v:"weekly",libraries:"marker",mapIds:"125ad7ffc6402a94"};O(W);let y=null;function q(n,e,r){let a=`
    <h3>${e.name}</h3>
    <p>${e.address}</p>
    <div>${e.openings}</div>
    <a href="https://www.google.com/maps?saddr=My+Location&daddr=${e.coords.lat},${e.coords.lng}" target="_blank">Directions</a>
    `,t=new google.maps.InfoWindow({content:a,ariaLabel:"la mia azienda"});n.addListener("click",o=>{y&&y.close(),t.open({anchor:n,map:r}),y=t})}let g=[],C=[],h,$=document.querySelector("#storesAmountContainer"),M=document.querySelector("#storesList"),u={lat:43,lng:12,zoom:6};function B(n,e,r){g=n,h=e,u=r||u}async function G(n,e){const{AdvancedMarkerElement:r,pinElement:a}=await google.maps.importLibrary("marker");n.forEach(o=>{let i=new r({position:o.coords,map:e,title:"Clicca per maggiori info"});q(i,o,e),C.push(i)}),new markerClusterer.MarkerClusterer({markers:C,map:e,imagePath:"../cat.jpg"})}let L=null;function T(n,e,r){let a=`
    <h3>${e.name}</h3>
    <p>${e.address}</p>
    <div>${e.openings}</div>
    <a href="https://www.google.com/maps?saddr=My+Location&daddr=${e.coords.lat},${e.coords.lng}" target="_blank">Directions</a>
    `,t=new google.maps.InfoWindow({content:a,ariaLabel:"la mia azienda"});L&&L.close(),t.open({anchor:n,map:r}),L=t}let E=[];async function N(n,e){const{AdvancedMarkerElement:r,pinElement:a}=await google.maps.importLibrary("marker");let t=n,o=new r({position:t.coords,map:e,title:"Clicca per maggiori info"});T(o,t,e),E.push(o),new markerClusterer.MarkerClusterer({markers:E,map:e,imagePath:"../cat.jpg"})}async function k(){try{const n=await fetch("stores.json").then(e=>e.json()).then(e=>e.stores);B(n,h,u),$.textContent=g.length,Z(h,u.lat,u.lng,u.zoom,g),b(g,h)}catch(n){console.log(n),document.querySelector("#map").innerHTML=`
      <h1>...map not loaded correctly</h1>
    `}}k();async function x(n,e,r,a,t,o){let i=document.querySelector("#categoryButtonsContainer");if(i.children.length===4){let c=document.createElement("button");c.classList.add("zoomBtn"),c.textContent="Remove zoom",i.append(c),c.addEventListener("click",async function(){k(),c.remove()})}const{Map:l}=await google.maps.importLibrary("maps");n=new l(document.querySelector("#map"),{center:{lat:e,lng:r},zoom:a,mapId:"125ad7ffc6402a94"}),N(t,n)}function D(n){let e=null,r=null;document.querySelector("#categoryButtonsContainer").addEventListener("click",function(i){if(i.target.nodeName==="BUTTON"){e=i.target.attributes[0].nodeValue;let l=i.target;document.querySelectorAll("#categoryButtonsContainer button").forEach(s=>s.classList.remove("active")),l.classList.add("active"),o(n,e,r)}}),document.querySelector("#searchContainer input").addEventListener("input",function(i){r=i.target.value,o(n,e,r)});function o(i,l=null,c=null){let s=i;l&&l!=="all"&&(s=i.filter(d=>d.categories.includes(l))),c&&(s=c?i.filter(d=>d.name.toLowerCase().includes(c)):i),M.innerHTML="",s.forEach(d=>{S(d)})}}function b(n){n.forEach(e=>{S(e,n)}),D(n)}function S(n,e){let r=document.createElement("div");r.classList.add("storeCard"),r.innerHTML=`
    <h3>${n.name}</h3>
    <p>${n.email}</p>
    <p>${n.address}</p>
    <p>${n.openings}</p>
    <p>${n.categories}</p>
    <a href="https://www.google.com/maps?saddr=My+Location&daddr=${n.coords.lat},${n.coords.lng}" target="_blank"">directions</a>
  `,r.addEventListener("click",function(){let a=this.children[0].innerText;for(let t=0;t<e.length;t++)if(e[t].name===a){let o=e[t].coords.lat,i=e[t].coords.lng;x(map,o,i,10,e[t])}}),M.append(r)}function j(n){storesAmountContainer.addEventListener("mouseenter",function(){let e=document.querySelector("#storesDropdown");if(e.innerHTML="",e.children.length===0)for(let r=0;r<n.length;r++){let a=document.createElement("li"),t=document.createElement("a");t.textContent=`${n[r].name}`,t.setAttribute("href",`https://www.google.com/maps?saddr=My+Location&daddr=${n[r].coords.lat},${n[r].coords.lng}`),t.setAttribute("target","_blank"),a.append(t),e.append(a),e.style.display="block",e.addEventListener("mouseleave",function(){e.style.display="none"}),t.addEventListener("mouseenter",function(o){if(o.target.childNodes.length<=1){let i=document.createElement("span");i.classList="go",i.textContent="go!",a.append(i)}}),t.addEventListener("mouseleave",function(o){o.target.nextElementSibling.remove()})}})}function R(n,e,r){n.addListener("zoom_changed",()=>{const a=n.getBounds();let t=[];for(let o=0;o<e.length;o++)e[o].coords.lat>a.ei.lo&&e[o].coords.lat<a.ei.hi&&e[o].coords.lng>a.Gh.lo&&e[o].coords.lng<a.Gh.hi&&t.push(e[o]);b(t),r.textContent=t.length}),n.addListener("bounds_changed",()=>{const a=n.getBounds();let t=[];for(let o=0;o<e.length;o++)e[o].coords.lat>a.ei.lo&&e[o].coords.lat<a.ei.hi&&e[o].coords.lng>a.Gh.lo&&e[o].coords.lng<a.Gh.hi&&t.push(e[o]),r.textContent=t.length;b(t),j(t)})}async function Z(n,e,r,a,t){const{Map:o}=await google.maps.importLibrary("maps");n=new o(document.querySelector("#map"),{center:{lat:e,lng:r},zoom:a,mapId:"125ad7ffc6402a94"}),G(t,n),R(n,t,$)}
